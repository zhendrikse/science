<style>
    html, body {
        background: #131313;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        height: 100%;
    }

    #glowscript-wrapper {
        display: block;
        position: relative;
        width: 100%;
        max-width: 800px;
        aspect-ratio: 4 / 3;
        margin: auto;
    }

    .glowscript canvas {
        display: block;
        touch-action: none;
        width: 100%;
        height: 100%;
    }
</style>
<script>
    // Disable MathJax within GlowScript library
    // if (window.MathJax && !MathJax.Hub) {
    //     MathJax.Hub = {
    //         Configured: function(){},
    //         Config: function(){},
    //         Queue: function(){},
    //         Typeset: function(){}
    //     };
    // }
</script>
<div id="glowscript-wrapper">
    <div id="glowscript" class="glowscript"></div>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link type="text/css" href="https://www.glowscript.org/css/redmond/2.1/jquery-ui.custom.css" rel="stylesheet" />
    <link type="text/css" href="https://www.glowscript.org/css/ide.css" rel="stylesheet" />
    <script type="text/javascript" src="https://www.glowscript.org/lib/jquery/2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.glowscript.org/lib/jquery/2.1/jquery-ui.custom.min.js"></script>
    <script type="text/javascript" src="https://www.glowscript.org/package/glow.3.2.min.js"></script>
    <script type="text/javascript" src="https://www.glowscript.org/package/RSrun.3.2.min.js"></script>
    <script type="text/javascript"><!--//--><![CDATA[//><!--

    // START JAVASCRIPT
    ;(function() {;
        var ρσ_modules = {};
        var pull, chosenObject, cart, force_arrow;
        ρσ_modules.pythonize = {};

        (function(){
            function strings() {
                var string_funcs, exclude, name;
                string_funcs = set("capitalize strip lstrip rstrip islower isupper isspace lower upper swapcase center count endswith startswith find rfind index rindex format join ljust rjust partition rpartition replace split rsplit splitlines zfill".split(" "));
                if (!arguments.length) {
                    exclude = (function(){
                        var s = ρσ_set();
                        s.jsset.add("split");
                        s.jsset.add("replace");
                        return s;
                    })();
                } else if (arguments[0]) {
                    exclude = Array.prototype.slice.call(arguments);
                } else {
                    exclude = null;
                }
                if (exclude) {
                    string_funcs = string_funcs.difference(set(exclude));
                }
                var ρσ_Iter0 = string_funcs;
                ρσ_Iter0 = ((typeof ρσ_Iter0[Symbol.iterator] === "function") ? (ρσ_Iter0 instanceof Map ? ρσ_Iter0.keys() : ρσ_Iter0) : Object.keys(ρσ_Iter0));
                for (var ρσ_Index0 of ρσ_Iter0) {
                    name = ρσ_Index0;
                    (ρσ_expr_temp = String.prototype)[(typeof name === "number" && name < 0) ? ρσ_expr_temp.length + name : name] = (ρσ_expr_temp = ρσ_str.prototype)[(typeof name === "number" && name < 0) ? ρσ_expr_temp.length + name : name];
                }
            };
            if (!strings.__module__) Object.defineProperties(strings, {
                __module__ : {value: "pythonize"}
            });

            ρσ_modules.pythonize.strings = strings;
        })();

        async function __main__() {
            "use strict";
            var display = canvas;
            var scene = canvas();

            function round(num, n=0) {return Number(num.toFixed(n))}
            var cone, curve, ellipsoid, extrusion, points, pyramid, ring, sphere, simple_sphere, group, vector, sleep, update, paths, shapes, vertex, triangle, quad, label, distant_light, local_light, attach_trail, attach_arrow, attach_light, sqrt, pi, sin, cos, tan, asin, acos, atan, atan2, exp, log, pow, factorial, combin, button, radio, checkbox, slider, checkbox, text, download, radians, degrees, get_library, read_local_file
            var version, print, arange, __name__, type, ρσ_ls, title, animation, g, _GS_1, cart, track, stop, spring, pull, chosenObject, force_arrow, delta_t, netForce;
            version = ρσ_list_decorate([ "3.2", "glowscript" ]);
            Array.prototype['+'] = function(r) {return this.concat(r)}
            Array.prototype['*'] = function(r) {return __array_times_number(this, r)}
            window.__GSlang = "vpython";
            print = GSprint;
            arange = range;
            __name__ = "__main__";
            type = pytype;
            var strings = ρσ_modules.pythonize.strings;

            strings();
            "10";
            title = "\n&#x2022; Based on <a href=\"https://bphilhour.trinket.io/physics-through-glowscript-an-introductory-course#/1-introduction-objects-parameters-and-the-3d-environment/optional-compound-objects\">this example<\/a> from tutorial by B. Philhour\n&#x2022; Refactored by <a href=\"https://www.hendrikse.name/\">Zeger Hendrikse</a> to <a href=\"https://github.com/zhendrikse/science/blob/main/kinematics/code/cart_on_spring.py\">cart_on_spring.py</a>\n&#x2022; Pull on cart with your mouse!\n\n";
            "12";
            animation = ρσ_interpolate_kwargs.call(this, canvas, [ρσ_desugar_kwargs({width: 600, height: 400, title: title, background: color.gray(.075), forward: vec(1["-u"]()["*"](.5), 1["-u"]()["*"](.3), 1["-u"]()["*"](.7)), center: vec(.07, 1["-u"]()["*"](.025), 0), range: .175})]);
            "15";
            g = 9.8;
            "18";
            function Cart() {;
            }
            Cart.prototype.__init__ = async function __init__(body_color) {
                var self = this;
                "20";
                self.L = .1;
                "21";
                self.W = .05;
                "22";
                self.H = .02;
                "23";
                self._mass = 1.5;
                "24";
                self._velocity = vec(1.5, 0, 0);
                "26";
                self.frame = ρσ_interpolate_kwargs.call(this, box, [ρσ_desugar_kwargs({pos: vec(0, 0, 0), size: vec(self.L, self.H, self.W), opacity: .6, color: body_color})]);
                "27";
                self.wheelFR = ρσ_interpolate_kwargs.call(this, cylinder, [ρσ_desugar_kwargs({pos: vec(.4["*"](self.L), 1["-u"]()["*"](.5)["*"](self.H), .4["*"](self.W)), radius: .5["*"](self.H), axis: vec(0, 0, .15["*"](self.W))})]);
                "29";
                self.wheelFL = ρσ_interpolate_kwargs.call(this, cylinder, [ρσ_desugar_kwargs({pos: vec(.4["*"](self.L), 1["-u"]()["*"](.5)["*"](self.H), 1["-u"]()["*"](.6)["*"](self.W)), radius: .5["*"](self.H), axis: vec(0, 0, .15["*"](self.W))})]);
                "31";
                self.wheelRR = ρσ_interpolate_kwargs.call(this, cylinder, [ρσ_desugar_kwargs({pos: vec(1["-u"]()["*"](.4)["*"](self.L), 1["-u"]()["*"](.5)["*"](self.H), .4["*"](self.W)), radius: .5["*"](self.H), axis: vec(0, 0, .15["*"](self.W))})]);
                "33";
                self.wheelRL = ρσ_interpolate_kwargs.call(this, cylinder, [ρσ_desugar_kwargs({pos: vec(1["-u"]()["*"](.4)["*"](self.L), 1["-u"]()["*"](.5)["*"](self.H), 1["-u"]()["*"](.6)["*"](self.W)), radius: .5["*"](self.H), axis: vec(0, 0, .15["*"](self.W))})]);
                "36";
                self.body = compound(ρσ_list_decorate([ self.frame, self.wheelFR, self.wheelFL, self.wheelRR, self.wheelRL ]));
            };
            if (!Cart.prototype.__init__.__argnames__) Object.defineProperties(Cart.prototype.__init__, {
                __argnames__ : {value: ["body_color"]},
                __module__ : {value: null}
            });
            Cart.__argnames__ = Cart.prototype.__init__.__argnames__;
            Cart.__handles_kwarg_interpolation__ = Cart.prototype.__init__.__handles_kwarg_interpolation__;
            Cart.prototype.update_by = async function update_by(force, dt) {
                var self = this;
                "39";
                self._velocity=self._velocity["+"](force["/"](self._mass)["*"](dt));
                "40";
                self.body.pos=self.body.pos["+"](self._velocity["*"](dt));
            };
            if (!Cart.prototype.update_by.__argnames__) Object.defineProperties(Cart.prototype.update_by, {
                __argnames__ : {value: ["force", "dt"]},
                __module__ : {value: null}
            });
            Cart.prototype.position = async function position() {
                var self = this;
                "43";
                return self.body.pos["+"](vec(1["-u"]()["*"](self.L)["/"](2), self.H["/"](4), 0));
            };
            if (!Cart.prototype.position.__module__) Object.defineProperties(Cart.prototype.position, {
                __module__ : {value: null}
            });
            Cart.prototype.hits_wall = async function hits_wall(wall_position) {
                var self = this;
                "46";
                return self.body.pos.x["<"](wall_position.x["+"](self.L["/"](2)));
            };
            if (!Cart.prototype.hits_wall.__argnames__) Object.defineProperties(Cart.prototype.hits_wall, {
                __argnames__ : {value: ["wall_position"]},
                __module__ : {value: null}
            });
            Cart.prototype.bounce = async function bounce(wall_position) {
                var self = this;
                "49";
                self._velocity.x=self._velocity.x["*"](1["-u"]()["*"](.5));
                "50";
                self.body.pos.x = wall_position.x["+"](self.L["/"](2));
            };
            if (!Cart.prototype.bounce.__argnames__) Object.defineProperties(Cart.prototype.bounce, {
                __argnames__ : {value: ["wall_position"]},
                __module__ : {value: null}
            });
            Cart.prototype.__repr__ = async function __repr__() {
                return "<"["+"](__name__)["+"](".")["+"](this.constructor.name)["+"](" #")["+"](this.ρσ_object_id)["+"](">");
            };
            Cart.prototype.__str__ = async function __str__() {
                return this.__repr__();
            };
            Object.defineProperty(Cart.prototype, "__bases__", {value: []});






            "53";
            function SpringElement() {;
            }
            SpringElement.prototype.__init__ = async function __init__(position, axis, radius, mass, length) {
                var self = this;
                "55";
                self._element = ρσ_interpolate_kwargs.call(this, helix, [ρσ_desugar_kwargs({pos: position, axis: axis, radius: radius, coils: 3})]);
                "56";
                self._velocity = vec(0, 0, 0);
                "57";
                self._mass = mass;
                "58";
                self._length = length;
                "59";
                self._force = vec(0, 0, 0);
            };
            if (!SpringElement.prototype.__init__.__argnames__) Object.defineProperties(SpringElement.prototype.__init__, {
                __argnames__ : {value: ["position", "axis", "radius", "mass", "length"]},
                __module__ : {value: null}
            });
            SpringElement.__argnames__ = SpringElement.prototype.__init__.__argnames__;
            SpringElement.__handles_kwarg_interpolation__ = SpringElement.prototype.__init__.__handles_kwarg_interpolation__;
            SpringElement.prototype.update_gravitational_force = async function update_gravitational_force(drag) {
                var self = this;
                "62";
                self._force = vec(0, 1["-u"]()["*"](self._mass)["*"](g), 0);
                "64";
                self._force=self._force["-"](drag["*"](self._velocity));
            };
            if (!SpringElement.prototype.update_gravitational_force.__argnames__) Object.defineProperties(SpringElement.prototype.update_gravitational_force, {
                __argnames__ : {value: ["drag"]},
                __module__ : {value: null}
            });
            SpringElement.prototype.update_left_element = async function update_left_element(neighbor, k, top) {
                var self = this;
                "67";
                self._force=self._force["+"](k["*"]((await neighbor.axis())["-"](1["*"](self._length)["*"]((await neighbor.axis()).norm()))));
                "68";
                self._element.pos = top;
                "69";
                self._element.axis = (await neighbor.position())["-"](1["*"](self._element.pos));
            };
            if (!SpringElement.prototype.update_left_element.__argnames__) Object.defineProperties(SpringElement.prototype.update_left_element, {
                __argnames__ : {value: ["neighbor", "k", "top"]},
                __module__ : {value: null}
            });
            SpringElement.prototype.update_right_element = async function update_right_element(neighbor, k, bottom) {
                var self = this;
                "72";
                self._force=self._force["-"](k["*"]((await neighbor.axis())["-"](1["*"](self._length)["*"]((await neighbor.axis()).norm()))));
                "73";
                self._element.pos = bottom;
                "74";
                self._element.axis = vec(0, 0, 0);
            };
            if (!SpringElement.prototype.update_right_element.__argnames__) Object.defineProperties(SpringElement.prototype.update_right_element, {
                __argnames__ : {value: ["neighbor", "k", "bottom"]},
                __module__ : {value: null}
            });
            SpringElement.prototype.axis = async function axis() {
                var self = this;
                "77";
                return self._element.axis;
            };
            if (!SpringElement.prototype.axis.__module__) Object.defineProperties(SpringElement.prototype.axis, {
                __module__ : {value: null}
            });
            SpringElement.prototype.position = async function position() {
                var self = this;
                "80";
                return self._element.pos;
            };
            if (!SpringElement.prototype.position.__module__) Object.defineProperties(SpringElement.prototype.position, {
                __module__ : {value: null}
            });
            SpringElement.prototype.force = async function force() {
                var self = this;
                "83";
                return self._force;
            };
            if (!SpringElement.prototype.force.__module__) Object.defineProperties(SpringElement.prototype.force, {
                __module__ : {value: null}
            });
            SpringElement.prototype.update_with = async function update_with(left_neighbor, right_neighbor, k, dt) {
                var self = this;
                var ρσ_ls, tension;
                "86";
                self._force=self._force["-"](k["*"]((await left_neighbor.axis())["-"](1["*"](self._length)["*"]((await left_neighbor.axis()).norm()))));
                "87";
                self._force=self._force["+"](k["*"]((await self.axis())["-"](1["*"](self._length)["*"]((await self.axis()).norm()))));
                "88";
                tension = k["*"](((await self.axis())["-"](1["*"](self._length)["*"]((await self.axis()).norm()))).mag);
                "89";
                self._velocity=self._velocity["+"](self._force["/"](self._mass)["*"](dt));
                "90";
                self._element.pos=self._element.pos["+"](self._velocity["*"](dt));
                "91";
                self._element.axis = (await right_neighbor.position())["-"](1["*"](self._element.pos));
                "92";
                return tension;
            };
            if (!SpringElement.prototype.update_with.__argnames__) Object.defineProperties(SpringElement.prototype.update_with, {
                __argnames__ : {value: ["left_neighbor", "right_neighbor", "k", "dt"]},
                __module__ : {value: null}
            });
            SpringElement.prototype.__repr__ = async function __repr__() {
                return "<"["+"](__name__)["+"](".")["+"](this.constructor.name)["+"](" #")["+"](this.ρσ_object_id)["+"](">");
            };
            SpringElement.prototype.__str__ = async function __str__() {
                return this.__repr__();
            };
            Object.defineProperty(SpringElement.prototype, "__bases__", {value: []});









            "95";
            function Spring() {;
            }
            Spring.prototype.__init__ = async function __init__(N, mass, k, drag, topPos, botPos, width) {
                var self = this;
                var ρσ_ls, line, element_length, _GS_1, i;
                "97";
                self._elements = ρσ_list_decorate([]);
                "98";
                self._drag = drag;
                "99";
                self._k = k;
                "100";
                self._topPos = topPos;
                "101";
                self._botPos = botPos;
                "103";
                line = botPos["-"](1["*"](topPos));
                "104";
                element_length = (topPos["-"](1["*"](botPos))).mag["/"](N);
                "105";
                for (var ρσ_Index1 = 0; ρσ_Index1["<"](N); ρσ_Index1++) {
                    i = ρσ_Index1;
                    "106";
                    _GS_1 = new SpringElement;
                    (await _GS_1.__init__(topPos["+"](i["/"](N)["*"](line)), element_length["*"](line.norm()), width["/"](2), mass["/"](N), element_length));
                    self._elements.append(_GS_1);
                }
            };
            if (!Spring.prototype.__init__.__argnames__) Object.defineProperties(Spring.prototype.__init__, {
                __argnames__ : {value: ["N", "mass", "k", "drag", "topPos", "botPos", "width"]},
                __module__ : {value: null}
            });
            Spring.__argnames__ = Spring.prototype.__init__.__argnames__;
            Spring.__handles_kwarg_interpolation__ = Spring.prototype.__init__.__handles_kwarg_interpolation__;
            Spring.prototype.update_by = async function update_by(dt) {
                var self = this;
                var ρσ_ls, total_elements, i, tension;
                "109";
                total_elements = len(self._elements);
                "110";
                for (var ρσ_Index2 = 0; ρσ_Index2["<"](total_elements); ρσ_Index2++) {
                    i = ρσ_Index2;
                    "111";
                    (await ρσ_getitem(self._elements, i).update_gravitational_force(self._drag));
                }
                "113";
                (await ρσ_getitem(self._elements, 0).update_left_element(ρσ_getitem(self._elements, 1), self._k, self._topPos));
                "114";
                tension = 0;
                "115";
                for (var ρσ_Index3 = 1; ρσ_Index3["<"](total_elements["-"](1["*"](1))); ρσ_Index3++) {
                    i = ρσ_Index3;
                    "116";
                    tension=tension["+"]((await ρσ_getitem(self._elements, i).update_with(ρσ_getitem(self._elements, i["-"](1["*"](1))), ρσ_getitem(self._elements, i["+"](1)), self._k, dt)));
                }
                "117";
                (await ρσ_getitem(self._elements, 1["-u"]()["*"](1)).update_right_element(ρσ_getitem(self._elements, 1["-u"]()["*"](2)), self._k, self._botPos));
                "119";
                return tension["/"](total_elements);
            };
            if (!Spring.prototype.update_by.__argnames__) Object.defineProperties(Spring.prototype.update_by, {
                __argnames__ : {value: ["dt"]},
                __module__ : {value: null}
            });
            Spring.prototype.force_on_last_element = async function force_on_last_element() {
                var self = this;
                "122";
                return (await ρσ_getitem(self._elements, 1["-u"]()["*"](1)).force());
            };
            if (!Spring.prototype.force_on_last_element.__module__) Object.defineProperties(Spring.prototype.force_on_last_element, {
                __module__ : {value: null}
            });
            Spring.prototype.update_with = async function update_with(cart_position) {
                var self = this;
                "125";
                self._botPos = cart_position;
            };
            if (!Spring.prototype.update_with.__argnames__) Object.defineProperties(Spring.prototype.update_with, {
                __argnames__ : {value: ["cart_position"]},
                __module__ : {value: null}
            });
            Spring.prototype.__repr__ = async function __repr__() {
                return "<"["+"](__name__)["+"](".")["+"](this.constructor.name)["+"](" #")["+"](this.ρσ_object_id)["+"](">");
            };
            Spring.prototype.__str__ = async function __str__() {
                return this.__repr__();
            };
            Object.defineProperty(Spring.prototype, "__bases__", {value: []});





            "128";
            _GS_1 = new Cart;
            (await _GS_1.__init__(color.blue));
            cart = _GS_1;
            "129";
            track = ρσ_interpolate_kwargs.call(this, box, [ρσ_desugar_kwargs({pos: vec(0, 1["-u"]()["*"](.025), 0), size: vec(.5, .01, .08), texture: textures.wood})]);
            "130";
            stop = ρσ_interpolate_kwargs.call(this, box, [ρσ_desugar_kwargs({pos: vec(1["-u"]()["*"](.245), 0, 0), size: vec(.01, .04, .08), texture: textures.wood})]);
            "131";
            _GS_1 = new Spring;
            (await _GS_1.__init__(20, .1, 2500, .5, stop.pos, cart.body.pos["-"](1["*"](vec(cart.L["/"](2), 0, 0))), .01));
            spring = _GS_1;
            "133";
            pull = false;
            "134";
            chosenObject = null;
            "135";
            force_arrow = ρσ_interpolate_kwargs.call(this, arrow, [ρσ_desugar_kwargs({axis: vec(0, 0, 0), color: color.red, opacity: .5})]);
            "138";
            async function down() {
                "139";
                "140";
                chosenObject = animation.mouse.pick();
                "141";
                if ((chosenObject === cart.body || typeof chosenObject === "object" && ρσ_equals(chosenObject, cart.body))) {
                    "142";
                    pull = true;
                }
            };
            if (!down.__module__) Object.defineProperties(down, {
                __module__ : {value: null}
            });

            "145";
            async function move() {
                "146";
                "147";
                if (pull) {
                    "148";
                    force_arrow.pos = chosenObject.pos;
                    "149";
                    force_arrow.axis.x = animation.mouse.pos.x["-"](1["*"](chosenObject.pos.x));
                }
            };
            if (!move.__module__) Object.defineProperties(move, {
                __module__ : {value: null}
            });

            "152";
            async function up() {
                var ρσ_ls, offset;
                "153";
                "154";
                pull = false;
                "155";
                offset = vec(0, 0, 0);
                "156";
                force_arrow.axis = vec(0, 0, 0);
            };
            if (!up.__module__) Object.defineProperties(up, {
                __module__ : {value: null}
            });

            "159";
            animation.bind("mousedown", down);
            "160";
            animation.bind("mousemove", move);
            "161";
            animation.bind("mouseup", up);
            "163";
            delta_t = .001;
            "164";
            while (true) {
                "165";
                (await rate(1["/"](delta_t)));
                "168";
                netForce = vec(.1, 0, 0)["+"]((await spring.force_on_last_element()));
                "170";
                if (pull) {
                    "171";
                    netForce=netForce["+"](50["*"](force_arrow.axis));
                }
                "172";
                netForce.y = 0;
                "173";
                if ((await cart.hits_wall(stop.pos))) {
                    "174";
                    (await cart.bounce(stop.pos));
                }
                "175";
                (await cart.update_by(netForce, delta_t));
                "176";
                (await spring.update_with((await cart.position())));
                "177";
                (await spring.update_by(delta_t));
                "178";
                force_arrow.pos = cart.body.pos;
            }
        };
        if (!__main__.__module__) Object.defineProperties(__main__, {
            __module__ : {value: null}
        });

        ;$(function(){ window.__context = { glowscript_container: $("#glowscript") }; __main__() })})()
    // END JAVASCRIPT

    //--><!]]></script>
</div>